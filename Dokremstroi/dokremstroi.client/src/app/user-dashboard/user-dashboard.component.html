<h2>Личный кабинет</h2>
<p>Добро пожаловать в ваш личный кабинет!</p>

<h3>Ваши заказы</h3>
<div>
  <mat-form-field>
    <input matInput [matDatepicker]="picker" placeholder="Выберите дату" [readonly]="true" [(ngModel)]="searchQueryOrders" (dateChange)="onSearchOrders()">
    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
    <mat-datepicker #picker></mat-datepicker>
    <button mat-icon-button matSuffix *ngIf="searchQueryOrders" (click)="clearDate()">
      <mat-icon>close</mat-icon>
    </button>
  </mat-form-field>
</div>
<div *ngIf="orders.length > 0; else noOrders">
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Общая стоимость</th>
        <th>Дата заказа</th>
        <th>Статус</th>
        <th>Действия</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let order of orders">
        <td>{{ order.id }}</td>
        <td>{{ order.totalCost }}</td>
        <td>{{ order.orderDate | date }}</td>
        <td>{{ order.status }}</td>
        <td>
          <button *ngIf="!hasReview(order.id)" (click)="addReview(order.id)">Добавить отзыв</button>
          <span *ngIf="hasReview(order.id)">Отзыв оставлен</span>
        </td>
      </tr>
    </tbody>
  </table>
  <div class="pagination">
    <button (click)="onPageChangeOrders(currentPageOrders - 1)" [disabled]="currentPageOrders === 1">Предыдущая</button>
    <span>Страница {{ currentPageOrders }}</span>
    <button (click)="onPageChangeOrders(currentPageOrders + 1)" [disabled]="(currentPageOrders * itemsPerPageOrders) >= totalCountOrders">Следующая</button>
  </div>
</div>
<ng-template #noOrders>
  <p>У вас пока нет заказов.</p>
</ng-template>

<h3>Ваши отзывы</h3>
<div>
  <input matInput [(ngModel)]="searchQueryReviews" (ngModelChange)="onSearchReviews()" placeholder="Поиск отзывов...">
</div>
<div *ngIf="reviews.length > 0; else noReviews">
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Идентификатор заказа</th>
        <th>Комментарий</th>
        <th>Оценка</th>
        <th>Подтвержден</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let review of reviews">
        <td>{{ review.id }}</td>
        <td>{{ review.userOrderId }}</td>
        <td>{{ review.comment }}</td>
        <td>{{ review.rating }}</td>
        <td>{{ review.isApproved ? 'Да' : 'Нет' }}</td>
      </tr>
    </tbody>
  </table>
  <div class="pagination">
    <button (click)="onPageChangeReviews(currentPageReviews - 1)" [disabled]="currentPageReviews === 1">Предыдущая</button>
    <span>Страница {{ currentPageReviews }}</span>
    <button (click)="onPageChangeReviews(currentPageReviews + 1)" [disabled]="(currentPageReviews * itemsPerPageReviews) >= totalCountReviews">Следующая</button>
  </div>
</div>
<ng-template #noReviews>
  <p>У вас пока нет отзывов.</p>
</ng-template>
